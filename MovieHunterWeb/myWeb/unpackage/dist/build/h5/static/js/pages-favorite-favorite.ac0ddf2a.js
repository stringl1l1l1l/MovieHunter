(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-favorite-favorite"],{"49e1":function(t,e,o){var i=o("24fb");e=i(!1),e.push([t.i,".movie-list[data-v-25bbbd6c]{display:flex;flex-direction:column;align-items:center;padding:20px;z-index:0}.movie-item[data-v-25bbbd6c]{width:100%;max-width:600px;border:1px solid #e0e0e0;border-radius:5px;margin-bottom:20px;padding:15px;box-shadow:0 2px 4px rgba(0,0,0,.1);background-color:#fff}",""]),t.exports=e},"57ab":function(t,e,o){"use strict";o.r(e);var i=o("d565"),n=o.n(i);for(var s in i)["default"].indexOf(s)<0&&function(t){o.d(e,t,(function(){return i[t]}))}(s);e["default"]=n.a},"9eb5":function(t,e,o){var i=o("49e1");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var n=o("4f06").default;n("52298610",i,!0,{sourceMap:!1,shadowMode:!1})},c95d:function(t,e,o){"use strict";o.r(e);var i=o("e06b"),n=o("57ab");for(var s in n)["default"].indexOf(s)<0&&function(t){o.d(e,t,(function(){return n[t]}))}(s);o("e09f");var a=o("f0c5"),u=Object(a["a"])(n["default"],i["b"],i["c"],!1,null,"25bbbd6c",null,!1,i["a"],void 0);e["default"]=u.exports},d565:function(t,e,o){"use strict";o("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,o("d9e2"),o("d401");var i={data:function(){return{favorites:[],userId:"",movies:[],isMoviesShow:!1,token:"",selectFavoriteId:0}},methods:{deleteFavorite:function(t){console.log(t);var e=this;uni.showModal({title:"确认删除？",success:function(o){o.confirm&&uni.request({url:e.$BASE_URL.BASE_URL+"favorite/deleteFavoriteById/"+t,method:"DELETE",header:{token:e.token},success:function(t){200==t.data.code&&uni.showToast({title:"删除成功"}),e.showFavorite()},complete:function(t){console.log(t)}})}})},showFavorite:function(){var t=this;uni.request({url:this.$BASE_URL.BASE_URL+"favorite/insertFavorite/"+t.userId,header:{token:t.token},method:"GET",success:function(e){200==e.data.code?t.favorites=e.data.data:console.log(e)},fail:function(t){console.log(t),uni.showToast({title:"网络出错了",icon:"error"})},complete:function(t){console.log(t)}})},showFavoriteMovies:function(t){console.log(t);var e=this;this.selectFavoriteId=t,uni.request({url:this.$BASE_URL.BASE_URL+"favorite/findAllMoviesInFavorite/"+t,method:"GET",header:{token:e.token},success:function(t){200==t.data.code?(e.movies=t.data.data,0==t.data.data.length?uni.showToast({title:"暂无电影",icon:"error"}):e.isMoviesShow=!0):console.log(t)},fail:function(t){console.log(t),uni.showToast({title:"网络出错了",icon:"error"})},complete:function(t){console.log(t)}})},close:function(){this.isMoviesShow=!1},deleteMovie:function(t){console.log(t);uni.request({url:this.$BASE_URL.BASE_URL+"favorite/deleteMovieInFavorite",method:"DELETE",header:{token:this.token},data:{favoriteId:this.selectFavoriteId,movieId:t},success:function(t){200==t.data.code?uni.showToast({title:"移除成功"}):console.log(t)},fail:function(t){console.log(t),uni.showToast({title:"网络出错了",icon:"error"})},complete:function(t){console.log(t)}}),this.showFavoriteMovies(this.selectFavoriteId)}},onLoad:function(t){var e=this;uni.getStorage({key:"token",success:function(t){e.token=t.data},fail:function(){uni.showToast({icon:Error,title:"登录校验失败，请重新登录"}),uni.redirectTo({url:"/pages/Login/LoginByEmail"})}}),this.userId=t.userId,this.showFavorite()}};e.default=i},e06b:function(t,e,o){"use strict";o.d(e,"b",(function(){return n})),o.d(e,"c",(function(){return s})),o.d(e,"a",(function(){return i}));var i={uList:o("9272").default,uListItem:o("fcbd").default,uRow:o("1948").default,uCol:o("5d14").default,uButton:o("8b82").default,uPopup:o("319b").default},n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-uni-view",[o("u-list",t._l(t.favorites,(function(e){return o("u-list-item",{key:e.favoriteId},[o("u-row",{attrs:{justify:"between"}},[o("u-col",{attrs:{span:"5"},on:{click:function(o){arguments[0]=o=t.$handleEvent(o),t.showFavoriteMovies(e.favoriteId)}}},[t._v(t._s(e.name))]),o("u-col",{attrs:{span:"1"}},[o("u-button",{staticClass:"button",attrs:{text:"移除",type:"warning"},on:{click:function(o){arguments[0]=o=t.$handleEvent(o),t.deleteFavorite(e.favoriteId)}}})],1)],1)],1)})),1),t._v("."),o("u-popup",{attrs:{show:t.isMoviesShow,closeable:!0,closeIconPos:"top-left",safeAreaInsetTop:!0},on:{close:function(e){arguments[0]=e=t.$handleEvent(e),t.close.apply(void 0,arguments)}}},[o("u-list",{staticClass:"movie-list"},t._l(t.movies,(function(e){return o("u-list-item",{key:e.movieId},[o("u-row",[o("u-col",{attrs:{span:"5"}},[t._v(t._s(e.name))]),o("u-col",{attrs:{span:"1"}}),o("u-button",{staticClass:"button",attrs:{text:"移除",type:"warning"},on:{click:function(o){arguments[0]=o=t.$handleEvent(o),t.deleteMovie(e.movieId)}}})],1)],1)})),1),t._v(".")],1)],1)},s=[]},e09f:function(t,e,o){"use strict";var i=o("9eb5"),n=o.n(i);n.a}}]);