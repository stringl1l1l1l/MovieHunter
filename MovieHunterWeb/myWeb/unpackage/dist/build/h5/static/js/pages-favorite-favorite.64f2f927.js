(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-favorite-favorite"],{"043d":function(t,e,o){t.exports=o.p+"static/img/title.66356021.png"},"1ce3":function(t,e,o){t.exports=o.p+"static/img/movieTag.a60c112a.png"},3278:function(t,e,o){"use strict";var i=o("4dea"),a=o.n(i);a.a},"37ab":function(t,e,o){var i=o("24fb"),a=o("1de5"),n=o("043d");e=i(!1);var s=a(n);e.push([t.i,".scrollable-list[data-v-2c298150]{overflow-y:auto;height:100%}.popup-content[data-v-2c298150]{margin-top:20pt}.main[data-v-2c298150]{display:flex;justify-content:center;background-color:#f5f5f5}.close-button[data-v-2c298150]{position:absolute;top:1px;right:8px;font-size:36px;color:#999;cursor:pointer;\r\n  /* background-color: #333; */border-width:0}.close-button[data-v-2c298150]:hover{color:#333}.overlay[data-v-2c298150]{position:fixed;z-index:9999;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;background-color:rgba(0,0,0,.5)}.sub-window[data-v-2c298150]{position:relative;width:300px;height:315px;background-color:#fff;border:1px solid #ccc;padding:16px}.sub-window-create[data-v-2c298150]{position:relative;width:300px;height:100px;background-color:#fff;border:1px solid #ccc;padding:16px}.sub-window-big[data-v-2c298150]{position:relative;width:600px;height:700px;background-color:#fff;border:1px solid #ccc;padding:16px}.container[data-v-2c298150]{display:flex;align-items:center;padding:10px}.left-section[data-v-2c298150]{flex:1}.favorites-list[data-v-2c298150]{background-color:#f5f5f5;width:50%}.remove-button[data-v-2c298150]{color:#fff;border:none;border-radius:4px;cursor:pointer;min-width:80px; /* 调整按钮的最小宽度 */margin-left:10px /* 将按钮推至右侧 */}.edit-button[data-v-2c298150]{background-color:#007bff;color:#fff;border:none;border-radius:4px;cursor:pointer;min-width:80px; /* 调整按钮的最小宽度 */margin-left:10px /* 将按钮推至右侧 */}.favorite-item[data-v-2c298150]{\r\n  /* display: flex;\r\n   flex: 1 1 200px;\r\n  align-items: center; */justify-content:space-between;border:1px solid #e0e0e0;border-radius:5px;margin-bottom:20px;padding:15px;box-shadow:0 2px 4px rgba(0,0,0,.1);background-color:#fff}.favorite-info[data-v-2c298150]{display:flex;align-items:center}.favorite-name[data-v-2c298150]{margin-right:10px;cursor:pointer}.button[data-v-2c298150]{margin-left:10px}.movie-list[data-v-2c298150]{display:flex;flex-direction:column;align-items:center;padding:20px;z-index:0}.movie-item[data-v-2c298150]{width:100%;max-width:600px;border:1px solid #e0e0e0;border-radius:5px;margin-bottom:20px;padding:15px;box-shadow:0 2px 4px rgba(0,0,0,.1);background-color:#fff}.movie-item-small[data-v-2c298150]{width:100%;border:1px solid #e0e0e0;border-radius:5px;margin-bottom:20px;padding:15px;box-shadow:0 2px 4px rgba(0,0,0,.1);background-color:#fff}.text[data-v-2c298150]{font-size:16px;white-space:nowrap; /* 防止文字换行 */overflow:hidden; /* 超出部分隐藏 */text-overflow:ellipsis /* 超出部分显示省略号 */}.movie-name[data-v-2c298150]{margin:20px}.right-section[data-v-2c298150]{display:flex;margin-left:80px /* 将右侧按钮推至右边缘 */}.header[data-v-2c298150]{background-image:url("+s+");background-repeat:no-repeat;background-size:38% 100%;background-position:bottom;display:flex;align-items:center;justify-content:space-between;height:70px;background-color:#edf4ed}.box[data-v-2c298150]{display:flex;align-items:center}.nav_link[data-v-2c298150]{display:flex;align-items:center;padding:0 30px}.link_btn[data-v-2c298150]{text-decoration:none;color:#7f7f7f;font-size:25px;font-weight:400}.img_btn[data-v-2c298150]{width:30px;height:30px}.title_btn[data-v-2c298150]{width:40%;height:40%}.movie-list[data-v-2c298150]{display:flex;flex-direction:column;align-items:center;padding:20px;z-index:0}.movie-item[data-v-2c298150]{width:100%;max-width:600px;border:1px solid #e0e0e0;border-radius:5px;margin-bottom:20px;padding:15px;box-shadow:0 2px 4px rgba(0,0,0,.1);background-color:#fff}",""]),t.exports=e},"4dea":function(t,e,o){var i=o("37ab");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var a=o("4f06").default;a("12da1a76",i,!0,{sourceMap:!1,shadowMode:!1})},"57ab":function(t,e,o){"use strict";o.r(e);var i=o("d565"),a=o.n(i);for(var n in i)["default"].indexOf(n)<0&&function(t){o.d(e,t,(function(){return i[t]}))}(n);e["default"]=a.a},"5cbf":function(t,e,o){"use strict";o.d(e,"b",(function(){return a})),o.d(e,"c",(function(){return n})),o.d(e,"a",(function(){return i}));var i={uButton:o("8b82").default,uInput:o("d2a3").default,uRow:o("1948").default,uCol:o("5d14").default},a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",[i("meta",{attrs:{name:"referrer",content:"no-referrer"}}),i("div",[i("div",{staticClass:"header"},[i("div",{staticClass:"box"},[i("nav",{staticClass:"nav_link"},[i("img",{staticClass:"img_btn",attrs:{src:o("c655")}}),i("v-uni-text",{staticClass:"link_btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.handleClick("recommendations/recommendations")}}},[t._v("首页")])],1)]),i("div",{staticClass:"box"},[i("nav",{staticClass:"nav_link"},[i("img",{staticClass:"img_btn",attrs:{src:o("1ce3")}}),i("v-uni-text",{staticClass:"link_btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.handleClick("favorite/favorite")}}},[t._v("收藏夹")])],1),i("nav",{staticClass:"nav_link"},[i("img",{staticClass:"img_btn",attrs:{src:o("ec52")}}),i("v-uni-text",{staticClass:"link_btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.handleClick("UserInfo/UserInfo")}}},[t._v("个人主页")])],1),i("nav",{staticClass:"nav_link"},[i("img",{staticClass:"img_btn",attrs:{src:o("f7f0")}}),i("v-uni-text",{staticClass:"link_btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.handleClick("Login/LoginByEmail")}}},[t._v("退出")])],1)])])]),i("v-uni-view",{staticClass:"main"},[i("v-uni-view",{staticClass:"favorites-list"},[i("v-uni-button",{staticStyle:{"background-color":"aliceblue",margin:"10pt"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.createBtn()}}},[t._v("新建收藏夹")]),t._l(t.favorites,(function(e){return i("v-uni-view",{key:e.favoriteId,staticClass:"favorite-item"},[i("v-uni-view",{staticClass:"container"},[i("v-uni-view",{staticClass:"left-section"},[i("v-uni-text",{staticClass:"text"},[t._v(t._s(e.name))])],1),i("v-uni-view",{staticClass:"right-section"},[i("u-button",{staticClass:"edit-button",attrs:{text:"查看"},on:{click:function(o){arguments[0]=o=t.$handleEvent(o),t.showFavoriteMovies(e.favoriteId)}}}),i("u-button",{staticClass:"edit-button",attrs:{text:"修改"},on:{click:function(o){arguments[0]=o=t.$handleEvent(o),t.editItem(e.favoriteId)}}}),i("u-button",{staticClass:"remove-button",attrs:{text:"移除",type:"warning"},on:{click:function(o){arguments[0]=o=t.$handleEvent(o),t.deleteFavorite(e.favoriteId)}}})],1)],1)],1)}))],2)],1),t.isCreateShow?i("v-uni-view",{staticClass:"overlay"},[i("div",{staticClass:"sub-window-create"},[i("div",{staticClass:"close-button",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closeSubWindow_create()}}},[t._v("×")]),i("u-input",{attrs:{placeholder:"请输入收藏夹名称"},model:{value:t.favoriteName,callback:function(e){t.favoriteName=e},expression:"favoriteName"}}),i("u-button",{staticStyle:{"margin-top":"10pt"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.createFavorite()}}},[t._v("点击创建")]),t.isErrorShow?i("v-uni-view",{staticStyle:{color:"red"}},[t._v(t._s(t.errorMessage))]):t._e()],1)]):t._e(),t.showPopup?i("v-uni-view",{staticClass:"overlay"},[i("div",{staticClass:"sub-window-create"},[i("div",{staticClass:"close-button",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closePopup()}}},[t._v("×")]),i("v-uni-input",{staticStyle:{"margin-top":"10pt"},attrs:{type:"text",placeholder:"请输入新名称"},model:{value:t.inputText,callback:function(e){t.inputText=e},expression:"inputText"}}),i("v-uni-button",{staticClass:"submit-button",staticStyle:{"margin-top":"10pt"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.submitText.apply(void 0,arguments)}}},[t._v("提交")])],1)]):t._e(),t.isMoviesShow?i("v-uni-view",{staticClass:"overlay"},[i("div",{staticClass:"sub-window-big"},[i("div",{staticClass:"close-button",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closeMoviesShow()}}},[t._v("×")]),i("div",{staticClass:"scrollable-list"},[i("v-uni-view",{staticClass:"movie-list",staticStyle:{"margin-top":"10pt"}},t._l(t.movies,(function(e){return i("v-uni-view",{key:e.movieId,staticClass:"movie-item-small"},[i("u-row",[i("u-col",{attrs:{span:"6"}},[i("v-uni-text",{staticClass:"movie-name"},[t._v(t._s(e.name))])],1),i("u-col",{attrs:{span:"3"}},[i("u-button",{staticClass:"button",attrs:{text:"移除",type:"warning"},on:{click:function(o){arguments[0]=o=t.$handleEvent(o),t.deleteMovie(e.movieId)}}})],1),i("u-col",{attrs:{span:"3"}},[i("u-button",{staticClass:"button",attrs:{text:"移动",type:"primary"},on:{click:function(o){arguments[0]=o=t.$handleEvent(o),t.changeMovie(e.movieId)}}})],1)],1)],1)})),1)],1)])]):t._e(),t.showChange?i("v-uni-view",{staticClass:"overlay"},[i("div",{staticClass:"sub-window-big"},[i("div",{staticClass:"close-button",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closeShowChange()}}},[t._v("×")]),i("div",{staticClass:"scrollable-list"},[i("v-uni-view",{staticClass:"movie-list",staticStyle:{"margin-top":"10pt"}},t._l(t.favorites,(function(e){return i("v-uni-view",{key:e.favoriteId,staticClass:"movie-item-small"},[i("u-row",[i("u-col",{attrs:{span:"9"}},[i("v-uni-text",{staticClass:"movie-name"},[t._v(t._s(e.name))])],1),i("u-col",{attrs:{span:"3"}},[i("u-button",{staticClass:"button",attrs:{text:"移动",type:"primary"},on:{click:function(o){arguments[0]=o=t.$handleEvent(o),t.confirmChange(e.favoriteId)}}})],1)],1)],1)})),1)],1)])]):t._e()],1)},n=[]},c655:function(t,e,o){t.exports=o.p+"static/img/home.005ac1ba.png"},c95d:function(t,e,o){"use strict";o.r(e);var i=o("5cbf"),a=o("57ab");for(var n in a)["default"].indexOf(n)<0&&function(t){o.d(e,t,(function(){return a[t]}))}(n);o("3278");var s=o("f0c5"),c=Object(s["a"])(a["default"],i["b"],i["c"],!1,null,"2c298150",null,!1,i["a"],void 0);e["default"]=c.exports},d565:function(t,e,o){"use strict";o("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,o("d9e2"),o("d401");var i={data:function(){return{favorites:[],userId:"",movies:[],isMoviesShow:!1,token:"",selectFavoriteId:0,userinfo:{},showChange:!1,selectMovieId:0,showPopup:!1,inputText:"",isCreateShow:!1,isErrorShow:!1}},onLoad:function(){var t=this;uni.getStorage({key:"token",success:function(e){t.token=e.data},fail:function(){uni.showToast({icon:Error,title:"登录校验失败，请重新登录"}),uni.redirectTo({url:"/pages/Login/LoginByEmail"})}}),console.log(this.token),uni.request({url:this.$BASE_URL.BASE_URL+"user/parseToken/"+t.token,method:"GET",success:function(e){200==e.data.code?(console.log(e),t.userinfo=e.data.data,t.userId=e.data.data.userId,t.showFavorite()):console.log(e)},fail:function(t){console.log(t),uni.showToast({title:"网络出错了",icon:"fail"})}}),t.updateFavorite()},methods:{handleClick:function(t){uni.redirectTo({url:"/pages/"+t})},updateFavorite:function(){var t=this;uni.request({url:this.$BASE_URL.BASE_URL+"favorite/insertFavorite/"+t.userId,method:"GET",header:{token:t.token},success:function(e){console.log(e),t.favorites=e.data.data},fail:function(t){console.log(t),uni.showToast({title:"网络出错了",icon:"fail"})}})},showError:function(t){this.isErrorShow=!0,this.errorMessage=t},createFavorite:function(){var t=this;""==t.favoriteName&&(t.favoriteName="默认"),uni.request({url:this.$BASE_URL.BASE_URL+"favorite/insertFavorite",method:"PUT",header:{token:t.token},data:{userId:t.userId,name:t.favoriteName},success:function(e){200!=e.data.code?t.showError(e.data.message):(t.favoriteName="",t.isCreateShow=!1,t.updateFavorite(),uni.showToast({title:"创建成功"}))},fail:function(e){t.showError("网络出错了")}})},closeSubWindow_create:function(){this.isCreateShow=!1,this.isErrorShow=!1},createBtn:function(){this.isCreateShow=!0},confirmChange:function(t){console.log(t);var e=this;uni.request({url:this.$BASE_URL.BASE_URL+"favorite/moveMovieToFavorite/"+t,method:"POST",header:{token:e.token},data:{favoriteId:e.selectFavoriteId,movieId:e.selectMovieId},success:function(t){200==t.data.code?(e.closeShowChange(),e.closeMoviesShow(),uni.showToast({title:"移动成功"})):(e.closeShowChange(),e.closeMoviesShow(),uni.showToast({title:t.data.message,icon:"error"}))},fail:function(t){e.closeShowChange(),e.closeMoviesShow(),uni.showToast({title:"网络出错了",icon:"error"})}})},changeMovie:function(t){this.isMoviesShow=!1,this.showChange=!0,this.selectMovieId=t},editItem:function(t){this.showPopup=!0,this.selectFavoriteId=t,console.log(this.userId)},submitText:function(){var t=this;console.log(this.selectFavoriteId),console.log("提交的文本:",this.inputText),""==t.inputText&&(t.inputText="默认"),uni.request({url:this.$BASE_URL.BASE_URL+"favorite/updateFavouriteById",method:"POST",header:{token:t.token},data:{favoriteId:t.selectFavoriteId,userId:t.userId,name:t.inputText},success:function(e){200==e.data.code?(t.showFavorite(),uni.showToast({title:"修改成功"})):uni.showToast({title:e.data.message,icon:"error"})},complete:function(t){console.log(t)}}),this.showPopup=!1,this.inputText=""},deleteFavorite:function(t){console.log(t);var e=this;uni.showModal({title:"确认删除？",success:function(o){o.confirm&&uni.request({url:e.$BASE_URL.BASE_URL+"favorite/deleteFavoriteById/"+t,method:"DELETE",header:{token:e.token},success:function(t){200==t.data.code&&(e.showFavorite(),uni.showToast({title:"删除成功"}))},complete:function(t){console.log(t)}})}})},showFavorite:function(){var t=this;uni.request({url:this.$BASE_URL.BASE_URL+"favorite/findFavoritesByCurUser/",header:{token:t.token},method:"GET",success:function(e){200==e.data.code?t.favorites=e.data.data:console.log(e)},fail:function(t){console.log(t),uni.showToast({title:"网络出错了",icon:"error"})},complete:function(t){console.log(t)}})},showFavoriteMovies:function(t){console.log(t);var e=this;this.selectFavoriteId=t,uni.request({url:this.$BASE_URL.BASE_URL+"favorite/findAllMoviesInFavorite/"+t,method:"GET",header:{token:e.token},success:function(t){200==t.data.code?(e.movies=t.data.data,0==t.data.data.length?uni.showToast({title:"暂无电影",icon:"error"}):e.isMoviesShow=!0):console.log(t)},fail:function(t){console.log(t),uni.showToast({title:"网络出错了",icon:"error"})},complete:function(t){console.log(t)}})},closeMoviesShow:function(){this.isMoviesShow=!1},closeShowChange:function(){console.log("关闭"),this.showChange=!1},closePopup:function(){this.showPopup=!1},deleteMovie:function(t){console.log(t);var e=this;uni.request({url:this.$BASE_URL.BASE_URL+"favorite/deleteMovieInFavorite",method:"DELETE",header:{token:e.token},data:{favoriteId:e.selectFavoriteId,movieId:t},success:function(t){200==t.data.code?(e.closeMoviesShow(),uni.showToast({title:"移除成功"})):(e.closeMoviesShow(),uni.showToast({title:t.data.message,icon:"error"}))},fail:function(t){e.closeMoviesShow(),uni.showToast({title:"网络出错了",icon:"error"})},complete:function(t){e.closeMoviesShow(),console.log(t)}}),this.showFavoriteMovies(this.selectFavoriteId)}}};e.default=i},ec52:function(t,e,o){t.exports=o.p+"static/img/user.e83768c3.png"},f7f0:function(t,e,o){t.exports=o.p+"static/img/exit.faacf3cc.png"}}]);